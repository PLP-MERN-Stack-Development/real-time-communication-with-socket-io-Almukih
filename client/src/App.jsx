import React,{useContext,useState} from 'react'; import { UserProvider, UserContext } from './context/UserContext'; import { socket } from './socket/socket'; import ChatPage from './pages/ChatPage'; function InnerApp(){ const { user, setUser } = useContext(UserContext); const [name,setName]=useState(''); const join = ()=>{ if(!name.trim()) return alert('enter a name'); socket.emit('login',{ username: name }, (res)=>{ if(res && res.success){ setUser(res.user); socket.emit('join_room', { room: 'global' }); } else alert('login failed'); }); }; if(!user) return (<div className='login'><h2>Join Chat</h2><input placeholder='Username' value={name} onChange={(e)=>setName(e.target.value)} /><button onClick={join}>Join</button></div>); return <ChatPage />; } export default function App(){ return <UserProvider><InnerApp /></UserProvider>; }